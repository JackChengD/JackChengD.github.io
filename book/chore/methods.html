<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>重构手法 | Jack</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="describe myself">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.3b0e6309.js" as="script"><link rel="preload" href="/assets/js/2.eab5a6f5.js" as="script"><link rel="preload" href="/assets/js/26.b414405a.js" as="script"><link rel="prefetch" href="/assets/js/10.5e27a4b5.js"><link rel="prefetch" href="/assets/js/11.ca932ac6.js"><link rel="prefetch" href="/assets/js/12.d188360a.js"><link rel="prefetch" href="/assets/js/13.92c86ef1.js"><link rel="prefetch" href="/assets/js/14.6c8d2c9a.js"><link rel="prefetch" href="/assets/js/15.518bba56.js"><link rel="prefetch" href="/assets/js/16.c4f0feca.js"><link rel="prefetch" href="/assets/js/17.e2713cf6.js"><link rel="prefetch" href="/assets/js/18.9209155d.js"><link rel="prefetch" href="/assets/js/19.11b3dcb6.js"><link rel="prefetch" href="/assets/js/20.a04a6877.js"><link rel="prefetch" href="/assets/js/21.9ae791d8.js"><link rel="prefetch" href="/assets/js/22.ee2783e7.js"><link rel="prefetch" href="/assets/js/23.833e58e0.js"><link rel="prefetch" href="/assets/js/24.1947d05f.js"><link rel="prefetch" href="/assets/js/25.2e4832a9.js"><link rel="prefetch" href="/assets/js/27.bbe1ed06.js"><link rel="prefetch" href="/assets/js/28.9a0fbf54.js"><link rel="prefetch" href="/assets/js/29.f624ea12.js"><link rel="prefetch" href="/assets/js/3.88356f14.js"><link rel="prefetch" href="/assets/js/30.3efd22ac.js"><link rel="prefetch" href="/assets/js/31.544a2b7c.js"><link rel="prefetch" href="/assets/js/32.f684b4b4.js"><link rel="prefetch" href="/assets/js/33.086fdbe0.js"><link rel="prefetch" href="/assets/js/34.729b08b2.js"><link rel="prefetch" href="/assets/js/35.5aa6e77d.js"><link rel="prefetch" href="/assets/js/36.1ac36761.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.3822cadf.js"><link rel="prefetch" href="/assets/js/8.cc5610e5.js"><link rel="prefetch" href="/assets/js/9.932d38f4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jack</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/work/" class="nav-link">
  工作
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book/chore/" class="nav-link router-link-active">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/blog/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  leetcode
</a></div><div class="nav-item"><a href="/me/" class="nav-link">
  关于作者
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/work/" class="nav-link">
  工作
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书籍" class="dropdown-title"><span class="title">书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="书籍" class="mobile-dropdown-title"><span class="title">书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book/chore/" class="nav-link router-link-active">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/blog/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  leetcode
</a></div><div class="nav-item"><a href="/me/" class="nav-link">
  关于作者
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/book/chore" class="sidebar-heading clickable router-link-active open"><span>重构改善既有代码的设计</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/book/chore/what.html" class="sidebar-link">什么是重构</a></li><li><a href="/book/chore/why.html" class="sidebar-link">为什么要重构</a></li><li><a href="/book/chore/when.html" class="sidebar-link">什么时候要重构</a></li><li><a href="/book/chore/bad-smell.html" class="sidebar-link">代码的怪味道</a></li><li><a href="/book/chore/methods.html" aria-current="page" class="active sidebar-link">重构手法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/book/chore/methods.html#提炼函数-extract-function" class="sidebar-link">提炼函数(Extract Function)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#以函数调用取代内联代码-replace-inline-code-with-function-call" class="sidebar-link">以函数调用取代内联代码(Replace Inline Code with Function Call)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#查询取代临时变量-replace-temp-with-query" class="sidebar-link">查询取代临时变量(Replace Temp with Query)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#将查询函数和修改函数分离-separate-query-from-modifier" class="sidebar-link">将查询函数和修改函数分离(Separate Query from Modifier)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#内联变量-inline-variable" class="sidebar-link">内联变量(Inline Variable)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#改变函数声明-change-function-declaration" class="sidebar-link">改变函数声明(Change Function Declaration)</a></li><li class="sidebar-sub-header"><a href="/book/chore/methods.html#内联函数-inline-function" class="sidebar-link">内联函数(Inline Function)</a></li></ul></li><li><a href="/book/chore/good-words.html" class="sidebar-link">好句子</a></li><li><a href="/book/chore/from.html" class="sidebar-link">源自</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="重构手法"><a href="#重构手法" class="header-anchor">#</a> 重构手法</h1> <h2 id="提炼函数-extract-function"><a href="#提炼函数-extract-function" class="header-anchor">#</a> 提炼函数(Extract Function)</h2> <p>曾用名：提炼函数<br>
反向重构：内联函数</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">printOwing</span><span class="token punctuation">(</span><span class="token parameter">invoice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> outstanding <span class="token operator">=</span> <span class="token function">calculateOutstanding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// print details</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoice<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">amount：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>outstanding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">printOwing</span><span class="token punctuation">(</span><span class="token parameter">invoice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> outstanding <span class="token operator">=</span> <span class="token function">calculateOutstanding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printDetails</span><span class="token punctuation">(</span>outstanding<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">printDetails</span><span class="token punctuation">(</span><span class="token parameter">outstanding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>invoice<span class="token punctuation">.</span>customer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">amount:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>outstanding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="动机"><a href="#动机" class="header-anchor">#</a> 动机</h3> <p>1、函数过长；<br>
2、代码类似；<br>
3、明确代码用意。</p> <h3 id="做法"><a href="#做法" class="header-anchor">#</a> 做法</h3> <p>1、创建一个新函数（以它“做什么”来命名，而不是以它“怎么做”命名）；<br>
2、将待提炼的代码从源函数复制到新建的目标函数中；<br>
3、仔细检查提炼出的代码，看看其中是否引用了作用域限于源函数、在提炼出的新函数中访问不到的变量。若是，以参数的形式将它们传递给新函数；<br>
4、所有变量都处理完之后，编译；<br>
5、在源函数中，将被提炼代码段替换为对目标函数的调用；<br>
6、测试；<br>
7、查看其他代码是否有与被提炼的代码段相同或相似之处。如果有，考虑使用<a href="#%E4%BB%A5%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%8F%96%E4%BB%A3%E5%86%85%E8%81%94%E4%BB%A3%E7%A0%81-replace-inline-code-with-function-call">以函数调用取代内联代码</a>。</p> <h2 id="以函数调用取代内联代码-replace-inline-code-with-function-call"><a href="#以函数调用取代内联代码-replace-inline-code-with-function-call" class="header-anchor">#</a> 以函数调用取代内联代码(Replace Inline Code with Function Call)</h2> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> appliesToMass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> s <span class="token keyword">of</span> states<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">===</span> <span class="token string">&quot;MA&quot;</span><span class="token punctuation">)</span> appliesToMass <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  appliesToMass <span class="token operator">=</span> status<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;MA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="动机-2"><a href="#动机-2" class="header-anchor">#</a> 动机</h3> <p>1、善用函数可以将相关的行为打包起来；<br>
2、配合一些库函数使用，会使本手法效果更佳。</p> <h3 id="做法-2"><a href="#做法-2" class="header-anchor">#</a> 做法</h3> <p>1、将内联代码替代为对一个既有函数的调用；<br>
2、测试。</p> <h2 id="查询取代临时变量-replace-temp-with-query"><a href="#查询取代临时变量-replace-temp-with-query" class="header-anchor">#</a> 查询取代临时变量(Replace Temp with Query)</h2> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">get</span> <span class="token function">price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> basePrice <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_quantity <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_itemPrice<span class="token punctuation">;</span>
    <span class="token keyword">var</span> discountFactor <span class="token operator">=</span> <span class="token number">0.98</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> discountFactor <span class="token operator">-=</span> <span class="token number">0.03</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> basePrice <span class="token operator">*</span> discountFactor<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">get</span> <span class="token function">price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>basePrice <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discountFactor<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  
  <span class="token keyword">get</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_quantity <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_itemPrice<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">discountFactor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> discountFactor <span class="token operator">=</span> <span class="token number">0.98</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> discountFactor <span class="token operator">-=</span> <span class="token number">0.03</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> discountFactor<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="动机-3"><a href="#动机-3" class="header-anchor">#</a> 动机</h3> <p>1、避免在多个函数中重复编写计算逻辑；<br>
2、处理某些类型的临时变量；那些只被计算一次且之后不再被修改的变量。</p> <h3 id="做法-3"><a href="#做法-3" class="header-anchor">#</a> 做法</h3> <p>1、检查变量在使用前是否已经完全计算完毕，检查计算它的那段代码是否每次都能得到一样的值；<br>
2、如果变量目前不是只读的，但是可以改造成只读变量，那就先改造它；<br>
3、测试；<br>
4、将为变量赋值的代码段提炼成函数；</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果变量和函数不能使用同样的名字，那么先为函数取个临时的名字。<br>
确保待提炼函数没有副作用。若有，先应用<a href="#%E5%B0%86%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0%E5%92%8C%E4%BF%AE%E6%94%B9%E5%87%BD%E6%95%B0%E5%88%86%E7%A6%BBseparate-query-from-modifier">将查询函数和修改函数分离</a>手法隔离副作用。</p></div> <p>5、测试；<br>
6、应用<a href="#%E5%86%85%E8%81%94%E5%8F%98%E9%87%8Finline-variable">内联变量</a>手法移除临时变量。</p> <h2 id="将查询函数和修改函数分离-separate-query-from-modifier"><a href="#将查询函数和修改函数分离-separate-query-from-modifier" class="header-anchor">#</a> 将查询函数和修改函数分离(Separate Query from Modifier)</h2> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">getTotalOutstandingAndSendBill</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> customer<span class="token punctuation">.</span>invoices<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> each</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> each<span class="token punctuation">.</span>amount <span class="token operator">+</span> total<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sendBill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">totalOutstanding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> customer<span class="token punctuation">.</span>invoices<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> each</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> each<span class="token punctuation">.</span>amount <span class="token operator">+</span> total<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">sendBill</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    emailGateway<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token function">formatBill</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="动机-4"><a href="#动机-4" class="header-anchor">#</a> 动机</h3> <p>“既有返回值又有副作用”的函数，试着将查询动作从修改动作中分离出来。</p> <h3 id="做法-4"><a href="#做法-4" class="header-anchor">#</a> 做法</h3> <p>1、复制整个函数，将其作为一个查询来命名；</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果想不出好名字，可以看看函数返回的是什么。查询的结果会被填入一个变量，这个变量的名字应该能对函数如何命名有所启发。</p></div> <p>2、新建的查询函数中去掉所有造成副作用的语句；<br>
3、执行静态见检查；<br>
4、查找所有调用原函数的地方。如果调用处用到了该函数的返回值，就将其改为调用新建的查询函数，并在下面马上再调用一次原函数。每次修改之后都要测试；<br>
5、从原函数中去掉返回值；<br>
6、测试。<br>
完成重构之后，查询函数与原函数之间常会有重复代码，可以做必要的清理。</p> <h2 id="内联变量-inline-variable"><a href="#内联变量-inline-variable" class="header-anchor">#</a> 内联变量(Inline Variable)</h2> <p>曾用名：内联临时变量<br>
反向重构：提炼变量</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> basePrice <span class="token operator">=</span> anOrder<span class="token punctuation">.</span>basePrice<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">return</span> anOrder<span class="token punctuation">.</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="动机-5"><a href="#动机-5" class="header-anchor">#</a> 动机</h3> <p>1、变量名字并不比表达式本身更具有表现力；<br>
2、变量可能会妨碍重构附近的代码。</p> <h3 id="做法-5"><a href="#做法-5" class="header-anchor">#</a> 做法</h3> <p>1、检查确认变量赋值语句的右侧表达式没有副作用；<br>
2、如果变量没有被声明为不可修改，先将其变为不可修改，并执行测试；</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>这是为了确保该变量只被赋值一次。</p></div> <p>3、找到第一处使用该变量的地方，将其替换为直接使用赋值语句的右侧表达式；<br>
4、测试；<br>
5、重复前面两部，逐一替换其他使用该变量的地方；<br>
6、删除该变量的声明点和赋值语句；<br>
7、测试。</p> <h2 id="改变函数声明-change-function-declaration"><a href="#改变函数声明-change-function-declaration" class="header-anchor">#</a> 改变函数声明(Change Function Declaration)</h2> <p>别名：函数改名、修改签名<br>
曾用名：函数改名、添加参数、移除参数</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">circum</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><p>=&gt;</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">circumference</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="动机-6"><a href="#动机-6" class="header-anchor">#</a> 动机</h3> <p>1、有更好的函数名字；</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>一个好名字能让我们一眼看出函数的用途，而不必查看其实现代码。</p></div> <p>2、改变参数列表，使函数的应用范围增加。</p> <h3 id="做法-6"><a href="#做法-6" class="header-anchor">#</a> 做法</h3> <p>简单的做法：<br>
1、如果想要移除一个参数，需要先确定函数体内没有使用该参数；<br>
2、修改函数声明，使其成为你期望的状态；<br>
3、找出所有使用旧的函数声明的地方，将它们改为使用新得函数声明；<br>
4、测试。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>最好能把大的修改拆成小的步骤，所以如果你既想修改函数名，又想添加参数，最好分成两步来做。（并且，不论何时，如果遇到了麻烦，请撤销修改，并改用迁移式做法，）</p></div> <p>迁移式做法：<br>
1、如果有必要的话，先对函数内部加以重构，使后面的提炼步骤易于开展；<br>
2、使用<a href="#%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0extract-function">提炼函数</a>将函数提炼成一个新函数。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果你打算沿用旧函数的名字，可以先给新函数起一个易于搜索 的临时名字。</p></div> <p>3、如果提炼出的函数需要新增参数，用前面的简单做法添加即可；<br>
4、测试；<br>
5、对旧函数使用<a href="#%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0inline-function">内联函数</a>；<br>
6、如果新函数用了临时的名字，再次使用<a href="#%E6%94%B9%E5%8F%98%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8Echange-function-declaration">改变函数声明</a>将其改回原来的名字；<br>
7、测试。</p> <h2 id="内联函数-inline-function"><a href="#内联函数-inline-function" class="header-anchor">#</a> 内联函数(Inline Function)</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/book/chore/bad-smell.html" class="prev">
        代码的怪味道
      </a></span> <span class="next"><a href="/book/chore/good-words.html">
        好句子
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3b0e6309.js" defer></script><script src="/assets/js/2.eab5a6f5.js" defer></script><script src="/assets/js/26.b414405a.js" defer></script>
  </body>
</html>
